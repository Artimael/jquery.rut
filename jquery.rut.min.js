/* jQuery.rut.js */
!function(a){function c(a){return a.replace(/[\.\-]/g,"")}function d(a,b){rutAndDv=j(a);var c=rutAndDv[0],d=rutAndDv[1];if(!c||!d)return c||a;for(var e="",f=b?".":"";c.length>3;)e=f+c.substr(c.length-3)+e,c=c.substring(0,c.length-3);return c+e+"-"+d}function e(a){return a.type&&a.type.match(/^key(up|down|press)/)&&(8==a.keyCode||16==a.keyCode||17==a.keyCode||18==a.keyCode||20==a.keyCode||27==a.keyCode||37==a.keyCode||38==a.keyCode||39==a.keyCode||40==a.keyCode||91==a.keyCode)}function f(a){if("string"!=typeof a)return!1;var b=c(a);if(b.length<2)return!1;var d=b.charAt(b.length-1).toUpperCase(),e=parseInt(b.substr(0,b.length-1));return NaN!==e&&g(e).toString().toUpperCase()===d}function g(a){var b=0,c=2;if("number"==typeof a){a=a.toString();for(var d=a.length-1;d>=0;d--)b+=a.charAt(d)*c,c=(c+1)%8||2;switch(b%11){case 1:return"k";case 0:return 0;default:return 11-b%11}}}function h(a,b,c){a.val(d(a.val(),b))}function i(a,b){f(a.val())?a.trigger("rutValido",j(a.val())):a.trigger("rutInvalido")}function j(a){var b=c(a);if(0==b.length)return[null,null];if(1==b.length)return[b,null];var d=b.charAt(b.length-1),e=b.substring(0,b.length-1);return[e,d]}var b={validateOn:"blur",formatOn:"blur",ignoreControlKeys:!0,useThousandsSeparator:!0},k={init:function(c){if(this.length>1)for(var d=0;d<this.length;d++)console.log(this[d]),a(this[d]).rut(c);else{var f=this;f.opts=a.extend({},b,c),f.opts.formatOn&&f.on(f.opts.formatOn,function(a){f.opts.ignoreControlKeys&&e(a)||h(f,f.opts.useThousandsSeparator,a)}),f.opts.validateOn&&f.on(f.opts.validateOn,function(a){i(f,a)})}return this}};a.fn.rut=function(b){return k[b]?k[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("El mÃ©todo "+b+" no existe en jQuery.rut"):k.init.apply(this,arguments)},a.formatRut=function(a,b){return void 0===b&&(b=!0),d(a,b)},a.validateRut=function(b,c){if(f(b)){var d=j(b);return a.isFunction(c)&&c(d[0],d[1]),!0}return!1}}(jQuery);